#
#	Class to hold information about a Lateral Gene Transfer
#
#		Gaston H Gonnet (June 1st, 2008)
#
LateralGeneTransfer := proc(
	ID:string,
	    # a synthetic identifier (e.g. Class.OrtholNumber,
	    # Cyanobacteria827.  Should be unique and stable
	Reference:list(anything),
	    # a reference to the orthologous group which is the source
	    # of this candidate.  It is recommended to use a list with
	    # [filename,OGnumber,Row_of_OrtholMatrix]
	Donor:{0,Tree},
	    # The tree (rooted at the point of transfer) which
	    # was the source of the transfer (fitted to the group distances)
	DonorSpecies:list(string),
	    # list of the species below the transfer event
	Recipient:{0,Tree},
	    # The subtree of the Species Tree which has received the gene
	    # (fitted to the group distances)
	RecipientSpecies:list(string),
	    # list of the species in the recipient subtree
	SpeciesTree:{0,Tree},
	    # The species tree fitted for this group (normally a bad fit)
	Species:list(string),
	    # List of the name of all the species in this event
	SSR_LGT:numeric,
	    # Sum of Squared Residuals of the tree with the accepted
	    # lateral gene transfer (0 if unknown)
	SSR_Species:numeric,
	    # Sum of Squared Residuals of the tree with the original
	    # Species tree (0 if unknown)
	Score:positive,
	    #  10 * log10( Prob{LGT event} / Prob{no LGT event} )
        Delta:numeric,
            # distance from transfer to present species involved
	Dist:matrix(numeric),
	    # distance matrix for the group (same order as in Species)
	Var:matrix(numeric),
	    # variance matrix for the group (same order as in Species)
	Class:string,
	    # the source class for this orthologous group
	    # e.g. Cyanobacteria
	Origin:string,
	    # How this group was found, confirmed, etc.
	Comments:list(DatedComment)
	    # Any information worth recording
)
if nargs <> 17 then error('invalid number of arguments') fi;
noeval( procname(args) )
end:
CompleteClass( LateralGeneTransfer );

DatedComment := proc( Date:string, Comment:string )
if nargs = 1 then noeval( procname( date(), args[1] ))
elif nargs <> 2 then error('invalid number of arguments')
else noeval(procname(args)) fi
end:
CompleteClass( DatedComment );
